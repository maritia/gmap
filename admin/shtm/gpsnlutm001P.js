function issouth(a){return"C"==a||"D"==a||"E"==a||"F"==a||"G"==a||"H"==a||"J"==a||"K"==a||"L"==a||"M"==a?!0:!1}function calczone(a){return 1+Math.floor((a+180)/6)}
function calcband(a){return-80<=a&&-72>a?"C":-72<=a&&-64>a?"D":-64<=a&&-56>a?"E":-56<=a&&-48>a?"F":-48<=a&&-40>a?"G":-40<=a&&-32>a?"H":-32<=a&&-24>a?"J":-24<=a&&-16>a?"K":-16<=a&&-8>a?"L":-8<=a&&0>a?"M":0<=a&&8>a?"N":8<=a&&16>a?"P":16<=a&&24>a?"Q":24<=a&&32>a?"R":32<=a&&40>a?"S":40<=a&&48>a?"T":48<=a&&56>a?"U":56<=a&&64>a?"V":64<=a&&72>a?"W":72<=a&&84>=a?"X":"?"}
function latlng2UTM(a,d){var b=Math.PI/180,h=6378137*(1-1/298.2572236),l=Math.sqrt(1-h/6378137*(h/6378137)),e=a*b;utmb=calcband(a);utmz=calczone(d);var f=3+6*(utmz-1)-180,c=1-h/6378137*(h/6378137),h=l*l/(1-l*l),l=6378137/Math.sqrt(1-Math.pow(l*Math.sin(e),2)),k=Math.pow(Math.tan(e),2),g=h*Math.pow(Math.cos(e),2),b=(d-f)*b*Math.cos(e),f=e*(1-c*(.25+c*(.046875+5*c/256)))-Math.sin(2*e)*c*(.375+c*(.09375+45*c/1024)),f=f+Math.sin(4*e)*c*c*(.05859375+45*c/1024),f=f-Math.sin(6*e)*(35/3072)*c*c*c,f=6378137*
f,c=.9996*l*b*(1+b*b*((1-k+g)/6+b*b*(5-18*k+k*k+72*g-58*h)/120))+5E5,e=.9996*(f-0+l*Math.tan(e)*b*b*(.5+b*b*((5-k+9*g+4*g*g)/24+b*b*(61-58*k+k*k+600*g-330*h)/720)));0>e&&(e+=1E7);return{utmzone:utmz,utmband:utmb,easting:c.toFixed(0),northing:e.toFixed(0)}}
function UTM2latlng(a,d,b,h){var l=Math.PI/180,e=6378137*(1-1/298.2572236),f=Math.sqrt(1-e/6378137*(e/6378137)),c=1-e/6378137*(e/6378137),e=f*f/(1-f*f);issouth(d)&&(b-=1E7);a=3+6*(a-1)-180;d=(1-Math.sqrt(1-f*f))/(1+Math.sqrt(1-f*f));b=(0+b/.9996)/(6378137*(1-c*(.25+c*(.046875+5*c/256))));c=b+d*(1.5-27*d*d/32)*Math.sin(2*b)+d*d*(1.3125-55*d*d/32)*Math.sin(4*b);c+=d*d*d*(151*Math.sin(6*b)/96+d*Math.sin(8*b)*1097/512);d=e*Math.pow(Math.cos(c),2);b=Math.pow(Math.tan(c),2);var k=6378137/Math.sqrt(1-Math.pow(f*
Math.sin(c),2)),f=k*(1-f*f)/(1-Math.pow(f*Math.sin(c),2)),g=(h-5E5)/(.9996*k);h=g*g*(.5-g*g*(5+3*b+10*d-4*d*d-9*e)/24)+Math.pow(g,6)*(61+90*b+298*d+45*b*b-252*e-3*d*d)/720;h=c-k*Math.tan(c)/f*h;e=g*(1+g*g*((-1-2*b-d)/6+g*g*(5-2*d+28*b-3*d*d+8*e+24*b*b)/120))/Math.cos(c);return{latitude:h/l,longitude:a+e/l}};